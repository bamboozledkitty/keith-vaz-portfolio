(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,22638,90385,11358,t=>{"use strict";var e=t.i(63373),r=t.i(75028),o=t.i(28331);let a="bamboozledkitty",i=o.default.env.NEXT_PUBLIC_GITHUB_CLIENT_ID||"";i||console.warn("[Auth] NEXT_PUBLIC_GITHUB_CLIENT_ID not set - OAuth login will fail");let s="user:email repo";t.s(["ADMIN_USERNAME",0,a,"GITHUB_CLIENT_ID",0,i,"GITHUB_OAUTH_SCOPES",0,s],90385);let n="github_oauth_token",u="github_user",l=()=>{let t=localStorage.getItem(n),e=localStorage.getItem(u),r=null;if(e)try{r=JSON.parse(e)}catch{localStorage.removeItem(u)}return{isAuthenticated:!!t&&!!r,isAdmin:r?.login===a,user:r,token:t}},c=async t=>{let e=await fetch("https://api.github.com/user",{headers:{Authorization:`Bearer ${t}`,Accept:"application/vnd.github.v3+json"}});if(!e.ok)throw Error("Failed to fetch GitHub user");return e.json()},h=(t,e)=>{localStorage.setItem(n,t),localStorage.setItem(u,JSON.stringify(e))},d=()=>{localStorage.removeItem(n),localStorage.removeItem(u)},g=o.default.env.NEXT_PUBLIC_CLOUDFLARE_WORKER_URL||"https://portfolio-auth.keith-klv.workers.dev",m=async(t,e)=>{let r=await fetch(g,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:t,state:e})});if(!r.ok)throw Error((await r.json().catch(()=>({error:"Unknown error"}))).error||"Failed to exchange token");let o=await r.json();if(!o.access_token)throw Error("No access token received");return o.access_token};t.s(["clearAuthState",0,d,"fetchGitHubUser",0,c,"getAuthState",0,l,"getGitHubOAuthUrl",0,t=>{let e,r,o=new URLSearchParams({client_id:i,redirect_uri:t,scope:s,state:(e=new Uint8Array(32),crypto.getRandomValues(e),r=Array.from(e,t=>t.toString(16).padStart(2,"0")).join(""),sessionStorage.setItem("oauth_state",r),r)});return`https://github.com/login/oauth/authorize?${o.toString()}`},"requestAccessToken",0,m,"saveAuthState",0,h,"verifyState",0,t=>{let e=sessionStorage.getItem("oauth_state");return sessionStorage.removeItem("oauth_state"),t===e}],11358);let A=(0,r.createContext)(void 0);t.s(["AuthProvider",0,({children:t})=>{let[o,a]=(0,r.useState)(l()),[i,s]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{(async()=>{let t=l();if(t.token&&t.user)try{await c(t.token)}catch(t){d(),a(l())}s(!1)})()},[]),(0,e.jsx)(A.Provider,{value:{isAuthenticated:o.isAuthenticated,isAdmin:o.isAdmin,user:o.user,token:o.token,setAuth:(t,e)=>{h(t,e),a(l())},logout:()=>{d(),a(l())},isLoading:i},children:t})},"useAuth",0,()=>{let t=(0,r.useContext)(A);if(void 0===t)throw Error("useAuth must be used within AuthProvider");return t}],22638)}]);